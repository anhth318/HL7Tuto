package com.tran.synchronizedhl7server.localmultithreadedserver;

import java.io.IOException;

import com.tran.hl7tutorial.create.AdtMessageFactory;

import ca.uhn.hl7v2.HL7Exception;
import ca.uhn.hl7v2.model.DataTypeException;
import ca.uhn.hl7v2.model.v24.message.ADT_A01;
import ca.uhn.hl7v2.model.v24.segment.MSH;

public class HL7ResourceExploiter {
	private ADT_A01 adtMsg;
	
	public HL7ResourceExploiter(){
		try {
			adtMsg = (ADT_A01) AdtMessageFactory.createMessage("A01");
			MSH mshSegment = adtMsg.getMSH();
			mshSegment.getMessageControlID().setValue("0");
		} catch (HL7Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
	
	public void increase(){
		MSH mshSegment = adtMsg.getMSH();
		int n = Integer.parseInt(mshSegment.getMessageControlID().toString());
		n = n + 1;
		try {
			mshSegment.getMessageControlID().setValue(Integer.toString(n));
		} catch (DataTypeException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
	
	public ADT_A01 getMsg(){
		return adtMsg;
	}
	
	public void setMsg(ADT_A01 msg){
		adtMsg = msg;
	}
	
}
